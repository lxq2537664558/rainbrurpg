<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RainbruRPG: editor/ogreview.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_43a791e896d8d98072bfdba3f0a4f574.html">editor</a></div>
<h1>ogreview.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *  Copyright 2006-2007 Jerome PASQUIER</span>
<a name="l00003"></a>00003 <span class="comment"> * </span>
<a name="l00004"></a>00004 <span class="comment"> *  This file is part of RainbruRPG.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> *  RainbruRPG is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> *  it under the terms of the GNU General Public License as published by</span>
<a name="l00008"></a>00008 <span class="comment"> *  the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00009"></a>00009 <span class="comment"> *  (at your option) any later version.</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *  RainbruRPG is distributed in the hope that it will be useful,</span>
<a name="l00012"></a>00012 <span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00013"></a>00013 <span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00014"></a>00014 <span class="comment"> *  GNU General Public License for more details.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> *  You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> *  along with RainbruRPG; if not, write to the Free Software</span>
<a name="l00018"></a>00018 <span class="comment"> *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA</span>
<a name="l00019"></a>00019 <span class="comment"> *  02110-1301  USA</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include "ogreview.h"</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include "mainwindow.h"</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;environmentsetup.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;highlightlistener.h&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include "selectionmanager.h"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include "globaluri.h"</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="keyword">using namespace </span>Ogre;
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#if !defined(Q_WS_WIN)</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#include &lt;QX11Info&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#endif</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00043"></a><a class="code" href="classOgreView.html#a52f2f678cbb6366e85b03c67ed62f68">00043</a> <a class="code" href="classOgreView.html#a52f2f678cbb6366e85b03c67ed62f68">OgreView::OgreView</a>(QWidget* parent) : QWidget(parent){
<a name="l00044"></a>00044   LOGI(<span class="stringliteral">"Creating OgreView"</span>);
<a name="l00045"></a>00045   <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a> = NULL;
<a name="l00046"></a>00046   <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a> = NULL;
<a name="l00047"></a>00047   <a class="code" href="classOgreView.html#71eb32d803b181331b017acf36cb4e6b">mVp</a> = NULL;
<a name="l00048"></a>00048   <a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a> = NULL;
<a name="l00049"></a>00049   <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a> = NULL;
<a name="l00050"></a>00050   <a class="code" href="classOgreView.html#7038312e507ac7700924fdce77ca99ef">mainSubEnt</a> = NULL;
<a name="l00051"></a>00051   <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a> = NULL;
<a name="l00052"></a>00052   
<a name="l00053"></a>00053   <a class="code" href="classOgreView.html#98d89fbe8c56e5c3b0eebe6dedc9dc38">mouseLeftPressed</a> = <span class="keyword">false</span>;
<a name="l00054"></a>00054   <a class="code" href="classOgreView.html#464d4de70fc5da6da7be73a99ede23e2">mouseRightPressed</a> = <span class="keyword">false</span>;
<a name="l00055"></a>00055   <a class="code" href="classOgreView.html#b4fa20a1236991778391bd811fb01c18">mouseMiddleBtn</a> = <span class="keyword">false</span>;
<a name="l00056"></a>00056   <a class="code" href="classOgreView.html#fe6a0cfa1b4db310ba7ad7879f185dad">isMoving</a> = <span class="keyword">false</span>;
<a name="l00057"></a>00057   <a class="code" href="classOgreView.html#0cd84f9c7776142b607b7c14e1f8190c">isLoopOn</a> = <span class="keyword">false</span>;
<a name="l00058"></a>00058   <a class="code" href="classOgreView.html#cc9779cb4662e6b9ee9b9219a1cebc0e">isAnimEnabled</a> = <span class="keyword">false</span>;
<a name="l00059"></a>00059   
<a name="l00060"></a>00060   <a class="code" href="classOgreView.html#4875c314d92b6f36a47ddc17743c273f">selectionCycle</a>=<span class="keyword">new</span> <a class="code" href="classRainbruRPG_1_1Editor_1_1SelectionCycle.html">SelectionCycle</a>();
<a name="l00061"></a>00061 
<a name="l00062"></a>00062   <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a> = Vector3::ZERO;
<a name="l00063"></a>00063   <a class="code" href="classOgreView.html#aa935c7485a2a04631bb39b6e99c3eeb">mMove</a> = 5;
<a name="l00064"></a>00064   <a class="code" href="classOgreView.html#31809f01cebf85412f164331cc3be78b">mRotate</a> = 0.0005;
<a name="l00065"></a>00065   <a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a> = QPoint(0, 0);
<a name="l00066"></a>00066   <a class="code" href="classOgreView.html#34f99f232fc0092400ed63c54b8cb85d">mousePressPos</a> = QPoint(0, 0);
<a name="l00067"></a>00067   <a class="code" href="classOgreView.html#b66bcbe83c54d01f6adbf274c0202b7f">angleX</a> = 0.0; <span class="comment">// Added these because the display started spinning</span>
<a name="l00068"></a>00068   <a class="code" href="classOgreView.html#d9bb889c7bec1d6f4f59c9e71c2e3023">angleY</a> = 0.0; <span class="comment">// when I upgraded to Qt4.2, they were left undefined.</span>
<a name="l00069"></a>00069   <a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a> = 0.0;
<a name="l00070"></a>00070   <a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a> = 0.0;
<a name="l00071"></a>00071   
<a name="l00072"></a>00072   <a class="code" href="classOgreView.html#dff6d816fe8d37f5d1af935cf33d7b06">FPS</a> = 0;
<a name="l00073"></a>00073   <a class="code" href="classOgreView.html#33f5fc2d5a2cb097f5a1863c024b3808">triangles</a> = 0;
<a name="l00074"></a>00074   
<a name="l00075"></a>00075   <a class="code" href="classOgreView.html#b08bbd5698d9cea317de87b5f4ed73b0">oldMsgLog</a> = <span class="stringliteral">""</span>;
<a name="l00076"></a>00076   
<a name="l00077"></a>00077   <a class="code" href="classOgreView.html#47562d65ee20d942bdd017cf2481a668">fogColor</a>.setAsRGBA(qRgba(0, 0, 0, 1));
<a name="l00078"></a>00078   <a class="code" href="classOgreView.html#0af2a60bcf255f1aa0a59930471af997">backgroundColor</a>.setAsRGBA(qRgba(0, 0, 0, 1));
<a name="l00079"></a>00079   <a class="code" href="classOgreView.html#739822518f8341a34b67a8e0c6d8600f">backgroundOldColor</a>.setRgba(qRgba(0, 0, 0, 1));
<a name="l00080"></a>00080   <a class="code" href="classOgreView.html#99859abd49bde56673db9b53c275c9a6">lightDiffuseColor</a>.setAsRGBA(qRgba(0, 0, 0, 1));
<a name="l00081"></a>00081   <a class="code" href="classOgreView.html#fbe254e16705a0511e256ba31b7d9eff">lightSpecularColor</a>.setAsRGBA(qRgba(0, 0, 0, 1));
<a name="l00082"></a>00082   <a class="code" href="classOgreView.html#ab806a2980425fb6d0346f062615560a">ambientLightColor</a>.setAsRGBA(qRgba(0, 0, 0, 1));
<a name="l00083"></a>00083   
<a name="l00084"></a>00084   setAcceptDrops(<span class="keyword">true</span>);
<a name="l00085"></a>00085   <a class="code" href="classOgreView.html#2819df2b29ad1a3cafa2070ed0cdb0cc">setupResources</a>();
<a name="l00086"></a>00086   <span class="comment">// Creates a timer to get interval between mouse press/release events</span>
<a name="l00087"></a>00087   <a class="code" href="classOgreView.html#d7371cc579784d1fbbf1dc37ceb0dc2a">mouseTimer</a>=Ogre::PlatformManager::getSingleton().createTimer();
<a name="l00088"></a>00088   LOGI(<span class="stringliteral">"OgreView created"</span>);
<a name="l00089"></a>00089   <a class="code" href="classOgreView.html#40205d0d424230a550ec15f6a2316e18">msClickTime</a>=200;
<a name="l00090"></a>00090 }
<a name="l00091"></a>00091 
<a name="l00095"></a><a class="code" href="classOgreView.html#8a10b67936df86fe519de8626412513e">00095</a> <a class="code" href="classOgreView.html#8a10b67936df86fe519de8626412513e">OgreView::~OgreView</a>(){
<a name="l00096"></a>00096   Ogre::PlatformManager::getSingleton().destroyTimer(<a class="code" href="classOgreView.html#d7371cc579784d1fbbf1dc37ceb0dc2a">mouseTimer</a>);
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keyword">delete</span> <a class="code" href="classOgreView.html#4875c314d92b6f36a47ddc17743c273f">selectionCycle</a>;
<a name="l00099"></a>00099   <a class="code" href="classOgreView.html#4875c314d92b6f36a47ddc17743c273f">selectionCycle</a>=NULL;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a> != NULL){
<a name="l00102"></a>00102     <span class="keyword">delete</span> <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>;
<a name="l00103"></a>00103     <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a> = 0;
<a name="l00104"></a>00104   }
<a name="l00105"></a>00105   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a> != NULL){
<a name="l00106"></a>00106     <span class="keyword">delete</span> <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>;
<a name="l00107"></a>00107     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a> = 0;
<a name="l00108"></a>00108   }
<a name="l00109"></a>00109   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#71eb32d803b181331b017acf36cb4e6b">mVp</a> != NULL){
<a name="l00110"></a>00110     <span class="keyword">delete</span> <a class="code" href="classOgreView.html#71eb32d803b181331b017acf36cb4e6b">mVp</a>;
<a name="l00111"></a>00111     <a class="code" href="classOgreView.html#71eb32d803b181331b017acf36cb4e6b">mVp</a> = 0;
<a name="l00112"></a>00112   }
<a name="l00113"></a>00113   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a> != NULL){
<a name="l00114"></a>00114     <span class="keyword">delete</span> <a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a>;
<a name="l00115"></a>00115     <a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a> = 0;
<a name="l00116"></a>00116   }
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00122"></a><a class="code" href="classOgreView.html#2819df2b29ad1a3cafa2070ed0cdb0cc">00122</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#2819df2b29ad1a3cafa2070ed0cdb0cc">OgreView::setupResources</a>(){
<a name="l00123"></a>00123   LOGI(<span class="stringliteral">"Setting OgreView ressources"</span>);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <span class="comment">// Setting up Ogre::Root</span>
<a name="l00126"></a>00126   <a class="code" href="classRainbruRPG_1_1Network_1_1GlobalURI.html">RainbruRPG::Network::GlobalURI</a> gu;
<a name="l00127"></a>00127   std::string plugFN=gu.<a class="code" href="classRainbruRPG_1_1Network_1_1GlobalURI.html#956de09f55a8c92e4fd58312d3fcac4b">getShareFile</a>(<span class="stringliteral">"config/plugins.cfg"</span>);
<a name="l00128"></a>00128   std::string ogreFN=gu.<a class="code" href="classRainbruRPG_1_1Network_1_1GlobalURI.html#5ebe85a07e479eae64d50ca958b941e5">getUserDirFile</a>(<span class="stringliteral">"ogre.cfg"</span>);
<a name="l00129"></a>00129   <a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a> = <span class="keyword">new</span> Ogre::Root(plugFN.c_str(), ogreFN.c_str(), <span class="stringliteral">"ogre.log"</span>);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   <a class="code" href="classOgreView.html#6dcac8e2e1bbff826d585b4450d23269">mLogListener</a> = <span class="keyword">new</span> <a class="code" href="classmyLogListener.html">myLogListener</a>();
<a name="l00132"></a>00132   LogManager::getSingleton().addListener(mLogListener);
<a name="l00133"></a>00133   
<a name="l00134"></a>00134   std::string resCfg=gu.<a class="code" href="classRainbruRPG_1_1Network_1_1GlobalURI.html#956de09f55a8c92e4fd58312d3fcac4b">getShareFile</a>(<span class="stringliteral">"config/resources.cfg"</span>);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   ConfigFile cf;
<a name="l00137"></a>00137   cf.load(resCfg);
<a name="l00138"></a>00138   
<a name="l00139"></a>00139   ConfigFile::SectionIterator seci = cf.getSectionIterator();
<a name="l00140"></a>00140   String secName, typeName, archName, shareArchName;
<a name="l00141"></a>00141   <span class="keywordflow">while</span>(seci.hasMoreElements()) {
<a name="l00142"></a>00142     secName = seci.peekNextKey();
<a name="l00143"></a>00143     ConfigFile::SettingsMultiMap* settings = seci.getNext();
<a name="l00144"></a>00144     ConfigFile::SettingsMultiMap::iterator i;
<a name="l00145"></a>00145     <span class="keywordflow">for</span>(i=settings-&gt;begin(); i!=settings-&gt;end(); ++i){
<a name="l00146"></a>00146       typeName = i-&gt;first;
<a name="l00147"></a>00147       archName = i-&gt;second;
<a name="l00148"></a>00148       shareArchName= gu.<a class="code" href="classRainbruRPG_1_1Network_1_1GlobalURI.html#956de09f55a8c92e4fd58312d3fcac4b">getShareFile</a>(archName);
<a name="l00149"></a>00149 
<a name="l00150"></a>00150       <span class="comment">// Logging</span>
<a name="l00151"></a>00151       LOGCATS(<span class="stringliteral">"secName :"</span>);
<a name="l00152"></a>00152       LOGCATS(secName.c_str());
<a name="l00153"></a>00153       LOGCATS(<span class="stringliteral">" typeName :"</span>);
<a name="l00154"></a>00154       LOGCATS(typeName.c_str());
<a name="l00155"></a>00155       LOGCATS(<span class="stringliteral">" archName :"</span>);
<a name="l00156"></a>00156       LOGCATS(shareArchName.c_str());
<a name="l00157"></a>00157       LOGCAT();
<a name="l00158"></a>00158 
<a name="l00159"></a>00159       ResourceGroupManager::getSingleton()
<a name="l00160"></a>00160         .addResourceLocation(shareArchName, typeName, secName);
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162   }
<a name="l00163"></a>00163   
<a name="l00164"></a>00164   <a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a>-&gt;restoreConfig();
<a name="l00165"></a>00165   LOGI(<span class="stringliteral">"Initialise Ogre Root"</span>);
<a name="l00166"></a>00166   <a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a>-&gt;initialise(<span class="keyword">false</span>);
<a name="l00167"></a>00167   LOGI(<span class="stringliteral">"OgreView ressources loadded"</span>);
<a name="l00168"></a>00168 }
<a name="l00169"></a>00169 
<a name="l00173"></a><a class="code" href="classOgreView.html#725a5d23ad80c3cbf512d19f6d05f6bc">00173</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#725a5d23ad80c3cbf512d19f6d05f6bc">OgreView::setupView</a>(){
<a name="l00174"></a>00174     <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>)
<a name="l00175"></a>00175         <span class="keywordflow">return</span>;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     NameValuePairList params;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="preprocessor">#if !defined(Q_WS_WIN)</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span>    QWidget *q_parent = dynamic_cast &lt;QWidget *&gt; (parent());
<a name="l00181"></a>00181     QX11Info xInfo = x11Info();
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     params[<span class="stringliteral">"parentWindowHandle"</span>] = Ogre::StringConverter::toString ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)xInfo.display()) +
<a name="l00184"></a>00184         <span class="stringliteral">":"</span> + Ogre::StringConverter::toString ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)xInfo.screen()) +
<a name="l00185"></a>00185         <span class="stringliteral">":"</span> + Ogre::StringConverter::toString ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)q_parent-&gt;winId());
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 <span class="preprocessor">#else</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span>        params[<span class="stringliteral">"externalWindowHandle"</span>] = Ogre::StringConverter::toString((size_t)(HWND)winId());
<a name="l00189"></a>00189 <span class="preprocessor">#endif</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span>
<a name="l00191"></a>00191     <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a> = <a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a>-&gt;createRenderWindow(<span class="stringliteral">"View"</span>, width(), height(), <span class="keyword">true</span>, &amp;params);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193     <span class="comment">// Do not change the name of the scenemanager or the </span>
<a name="l00194"></a>00194     <span class="comment">// camera because it is used to move the camera later</span>
<a name="l00195"></a>00195     <a class="code" href="classRainbruRPG_1_1Core_1_1EnvironmentSetup.html">EnvironmentSetup</a> es( <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>, <span class="stringliteral">"MainEditorView"</span>, <span class="stringliteral">"MainEditorCam"</span>);
<a name="l00196"></a>00196     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>=es.<a class="code" href="classRainbruRPG_1_1Core_1_1EnvironmentSetup.html#bd65ed17801105987bb89f9f6abf75d1">getSceneManager</a>();
<a name="l00197"></a>00197     <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>=es.<a class="code" href="classRainbruRPG_1_1Core_1_1EnvironmentSetup.html#b0436c56062c0a1bf0c6c28b12e530f6">getCamera</a>();
<a name="l00198"></a>00198     <a class="code" href="classOgreView.html#71eb32d803b181331b017acf36cb4e6b">mVp</a>=es.<a class="code" href="classRainbruRPG_1_1Core_1_1EnvironmentSetup.html#5f907cab69313fa2af06b9a9b07a40cb">getViewPort</a>();
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     SelectionManager::getSingleton().init(<a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>, <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     <a class="code" href="classOgreView.html#f823d38da59df79ff3f040530dc2d7b3">mRaySceneQuery</a>=<a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;createRayQuery(Ray());
<a name="l00203"></a>00203     <a class="code" href="classOgreView.html#f823d38da59df79ff3f040530dc2d7b3">mRaySceneQuery</a>-&gt;setSortByDistance( <span class="keyword">true</span> );
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;addRenderQueueListener(<span class="keyword">new</span> <a class="code" href="classRainbruRPG_1_1Core_1_1HighlightQueueListener.html">HighlightQueueListener</a>());
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     <span class="comment">// Scene manager used by the MeshViewer</span>
<a name="l00208"></a>00208     Ogre::SceneManager* sm2=Ogre::Root::getSingleton()
<a name="l00209"></a>00209       .createSceneManager(<span class="stringliteral">"DefaultSceneManager"</span>, <span class="stringliteral">"MeshViewerView"</span>);
<a name="l00210"></a>00210     sm2-&gt;setAmbientLight(ColourValue(1.0f, 1.0f, 1.0f, 1.0f));
<a name="l00211"></a>00211 
<a name="l00212"></a>00212     Ogre::Camera* cam2=sm2-&gt;createCamera(<span class="stringliteral">"MeshViewerCam"</span>);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="comment">// Creates MeshViewer SceneManager</span>
<a name="l00216"></a>00216     <span class="comment">//    Ogre::SceneManager* sm2= Ogre::Root::getSingleton()</span>
<a name="l00217"></a>00217     <span class="comment">//      .createSceneManager("DefaultSceneManager", "MeshViewerView");</span>
<a name="l00218"></a>00218     <span class="comment">//   Ogre::Camera* cam2= sm2-&gt;createCamera("MeshViewerCam");</span>
<a name="l00219"></a>00219 
<a name="l00220"></a>00220    <span class="comment">/*    mSceneMgr = mRoot-&gt;createSceneManager("PagingLandScapeSceneManager",</span>
<a name="l00221"></a>00221 <span class="comment">                                          "MainEditorView");</span>
<a name="l00222"></a>00222 <span class="comment"></span>
<a name="l00223"></a>00223 <span class="comment">    mSceneMgr-&gt;setWorldGeometry( "paginglandscape2.cfg" );</span>
<a name="l00224"></a>00224 <span class="comment">    mCamera = mSceneMgr-&gt;createCamera("MainEditorCam");</span>
<a name="l00225"></a>00225 <span class="comment"></span>
<a name="l00226"></a>00226 <span class="comment">    mCamera-&gt;setPosition(Vector3(800,200,1200));</span>
<a name="l00227"></a>00227 <span class="comment">    mCamera-&gt;lookAt(Vector3(0,0,0));</span>
<a name="l00228"></a>00228 <span class="comment"></span>
<a name="l00229"></a>00229 <span class="comment">    mVp = mRenderWindow-&gt;addViewport(mCamera);</span>
<a name="l00230"></a>00230 <span class="comment">    mVp-&gt;setBackgroundColour(ColourValue(0.58, 0.65, 0.76, 1));</span>
<a name="l00231"></a>00231 <span class="comment"></span>
<a name="l00232"></a>00232 <span class="comment">    ResourceGroupManager::getSingleton().initialiseAllResourceGroups();</span>
<a name="l00233"></a>00233 <span class="comment"></span>
<a name="l00234"></a>00234 <span class="comment">        createLight();</span>
<a name="l00235"></a>00235 <span class="comment"></span>
<a name="l00236"></a>00236 <span class="comment">        TextureManager::getSingleton().setDefaultNumMipmaps(5);</span>
<a name="l00237"></a>00237 <span class="comment">        MaterialManager::getSingleton().setDefaultTextureFiltering(Ogre::TFO_ANISOTROPIC);</span>
<a name="l00238"></a>00238 <span class="comment">    MaterialManager::getSingleton().setDefaultAnisotropy(2);</span>
<a name="l00239"></a>00239 <span class="comment"></span>
<a name="l00240"></a>00240 <span class="comment">    mCamera-&gt;setAspectRatio(Real(mVp-&gt;getActualWidth()) / Real(mVp-&gt;getActualHeight()));</span>
<a name="l00241"></a>00241 <span class="comment"></span>
<a name="l00242"></a>00242 <span class="comment">    */</span>
<a name="l00243"></a>00243 <span class="preprocessor">#if !defined(Q_WS_WIN) // Linux</span>
<a name="l00244"></a>00244 <span class="preprocessor"></span>    WId window_id;
<a name="l00245"></a>00245     <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>-&gt;getCustomAttribute(<span class="stringliteral">"GLXWINDOW"</span>, &amp;window_id);
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="comment">// Take over the ogre created window.</span>
<a name="l00248"></a>00248     QWidget::create(window_id);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>-&gt;reposition(x(),y());
<a name="l00251"></a>00251 <span class="preprocessor">#endif</span>
<a name="l00252"></a>00252 <span class="preprocessor"></span>
<a name="l00253"></a>00253     startTimer(5);
<a name="l00254"></a>00254 };
<a name="l00255"></a>00255 
<a name="l00261"></a><a class="code" href="classOgreView.html#04122c723f8e37e4d7f5a1bfb8ab4ff1">00261</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#04122c723f8e37e4d7f5a1bfb8ab4ff1">OgreView::paintEvent</a>(QPaintEvent *evt){
<a name="l00262"></a>00262   Q_UNUSED(evt);
<a name="l00263"></a>00263   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a> == NULL)
<a name="l00264"></a>00264     <a class="code" href="classOgreView.html#725a5d23ad80c3cbf512d19f6d05f6bc">setupView</a>();
<a name="l00265"></a>00265   
<a name="l00266"></a>00266   <a class="code" href="classOgreView.html#4dd888fcc5553c51cb50e375380aec69">update</a>();
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00274"></a><a class="code" href="classOgreView.html#39c762306a3b8cf15a999c3307898fc4">00274</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#39c762306a3b8cf15a999c3307898fc4">OgreView::timerEvent</a>(QTimerEvent* evt){
<a name="l00275"></a>00275   Q_UNUSED(evt);
<a name="l00276"></a>00276   <a class="code" href="classOgreView.html#4dd888fcc5553c51cb50e375380aec69">update</a>();
<a name="l00277"></a>00277   <a class="code" href="classOgreView.html#ae63234be6a75601abba67f89597afb6">updateAnim</a>();
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00283"></a><a class="code" href="classOgreView.html#4dd888fcc5553c51cb50e375380aec69">00283</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#4dd888fcc5553c51cb50e375380aec69">OgreView::update</a>(){
<a name="l00284"></a>00284   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a> != NULL){
<a name="l00285"></a>00285     <a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a>-&gt;_fireFrameStarted();
<a name="l00286"></a>00286     <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>-&gt;update();
<a name="l00287"></a>00287     
<a name="l00288"></a>00288     <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;moveRelative(<a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>);
<a name="l00289"></a>00289     <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;yaw(Radian(<a class="code" href="classOgreView.html#b66bcbe83c54d01f6adbf274c0202b7f">angleX</a>));
<a name="l00290"></a>00290     <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;pitch(Radian(<a class="code" href="classOgreView.html#d9bb889c7bec1d6f4f59c9e71c2e3023">angleY</a>));
<a name="l00291"></a>00291     
<a name="l00292"></a>00292     <a class="code" href="classOgreView.html#6e8074e8b0fa910723fd8771bb716ffa">updateStats</a>();
<a name="l00293"></a>00293     <a class="code" href="classOgreView.html#f49e3473dce797ea176509e951f3299d">mRoot</a>-&gt;_fireFrameEnded();
<a name="l00294"></a>00294   }
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00300"></a><a class="code" href="classOgreView.html#ae63234be6a75601abba67f89597afb6">00300</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#ae63234be6a75601abba67f89597afb6">OgreView::updateAnim</a>(){
<a name="l00301"></a>00301   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a> != NULL)
<a name="l00302"></a>00302     <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a>-&gt;addTime(<a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>-&gt;getBestFPS()/100000);
<a name="l00303"></a>00303 }
<a name="l00304"></a>00304 
<a name="l00310"></a><a class="code" href="classOgreView.html#96f984aecf43480456b027717e20d638">00310</a> Ogre::Entity* <a class="code" href="classOgreView.html#96f984aecf43480456b027717e20d638">OgreView::getMainEnt</a>(){
<a name="l00311"></a>00311   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a> != NULL)
<a name="l00312"></a>00312     <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>;
<a name="l00313"></a>00313   <span class="keywordflow">else</span>
<a name="l00314"></a>00314     <span class="keywordflow">return</span> 0;
<a name="l00315"></a>00315 }
<a name="l00316"></a>00316 
<a name="l00322"></a><a class="code" href="classOgreView.html#adeb0a1aa081fb87bfe0e4bbe71c7952">00322</a> <span class="keywordtype">float</span> <a class="code" href="classOgreView.html#adeb0a1aa081fb87bfe0e4bbe71c7952">OgreView::getFPS</a>(){
<a name="l00323"></a>00323   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#dff6d816fe8d37f5d1af935cf33d7b06">FPS</a>;
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00331"></a><a class="code" href="classOgreView.html#077fe9298b312cd5d9573cddcd19005c">00331</a> <span class="keywordtype">float</span> <a class="code" href="classOgreView.html#077fe9298b312cd5d9573cddcd19005c">OgreView::getTriangles</a>(){
<a name="l00332"></a>00332   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#33f5fc2d5a2cb097f5a1863c024b3808">triangles</a>;
<a name="l00333"></a>00333 }
<a name="l00334"></a>00334 
<a name="l00340"></a><a class="code" href="classOgreView.html#26f73d7abae13530d9784082f273cc0d">00340</a> Vector3 <a class="code" href="classOgreView.html#26f73d7abae13530d9784082f273cc0d">OgreView::getPosCamera</a>(){
<a name="l00341"></a>00341   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;getPosition();
<a name="l00342"></a>00342 }
<a name="l00343"></a>00343 
<a name="l00349"></a><a class="code" href="classOgreView.html#21ecfb56c20ca967e7f6191761a880f4">00349</a> Vector3 <a class="code" href="classOgreView.html#21ecfb56c20ca967e7f6191761a880f4">OgreView::getDirCamera</a>(){
<a name="l00350"></a>00350   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;getDirection();
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00358"></a><a class="code" href="classOgreView.html#6e8074e8b0fa910723fd8771bb716ffa">00358</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#6e8074e8b0fa910723fd8771bb716ffa">OgreView::updateStats</a>(){
<a name="l00359"></a>00359   <span class="keywordflow">try</span>{
<a name="l00360"></a>00360     <span class="keyword">const</span> RenderTarget::FrameStats&amp; stats = <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>-&gt;getStatistics();
<a name="l00361"></a>00361     <a class="code" href="classOgreView.html#dff6d816fe8d37f5d1af935cf33d7b06">FPS</a> = (int)stats.lastFPS;
<a name="l00362"></a>00362     <a class="code" href="classOgreView.html#33f5fc2d5a2cb097f5a1863c024b3808">triangles</a> = stats.triangleCount;
<a name="l00363"></a>00363   }
<a name="l00364"></a>00364   <span class="keywordflow">catch</span>(...){}
<a name="l00365"></a>00365 }
<a name="l00366"></a>00366 
<a name="l00372"></a><a class="code" href="classOgreView.html#a385e675de5e337c4dddb8007741f8e3">00372</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#a385e675de5e337c4dddb8007741f8e3">OgreView::resizeEvent</a>(QResizeEvent *evt){
<a name="l00373"></a>00373   Q_UNUSED(evt);
<a name="l00374"></a>00374   <span class="keywordflow">if</span> (<a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a> != NULL){
<a name="l00375"></a>00375 <span class="preprocessor">#if !defined(Q_WS_WIN) // Linux</span>
<a name="l00376"></a>00376 <span class="preprocessor"></span>    <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>-&gt;resize (width(), height());
<a name="l00377"></a>00377 <span class="preprocessor">#endif</span>
<a name="l00378"></a>00378 <span class="preprocessor"></span>    <a class="code" href="classOgreView.html#bdab2abcea6316226277a70da5b8f142">mRenderWindow</a>-&gt;windowMovedOrResized();
<a name="l00379"></a>00379     <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;setAspectRatio(Ogre::Real(<a class="code" href="classOgreView.html#71eb32d803b181331b017acf36cb4e6b">mVp</a>-&gt;getActualWidth()) 
<a name="l00380"></a>00380                             / Ogre::Real(<a class="code" href="classOgreView.html#71eb32d803b181331b017acf36cb4e6b">mVp</a>-&gt;getActualHeight()));
<a name="l00381"></a>00381   }
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00389"></a><a class="code" href="classOgreView.html#816d13b670503545076fdde2f4700bee">00389</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#816d13b670503545076fdde2f4700bee">OgreView::keyPressEvent</a>(QKeyEvent* evt){
<a name="l00390"></a>00390   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a> != NULL &amp;&amp; <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a> != NULL){
<a name="l00391"></a>00391     <span class="keywordflow">switch</span>(evt-&gt;key()){
<a name="l00392"></a>00392     <span class="keywordflow">case</span> Qt::Key_W:
<a name="l00393"></a>00393     <span class="keywordflow">case</span> Qt::Key_Up:
<a name="l00394"></a>00394       <a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a> = -0.1;
<a name="l00395"></a>00395       <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;pitch(Radian(<a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a>));
<a name="l00396"></a>00396       <span class="keywordflow">break</span>;
<a name="l00397"></a>00397     <span class="keywordflow">case</span> Qt::Key_S:
<a name="l00398"></a>00398     <span class="keywordflow">case</span> Qt::Key_Down:
<a name="l00399"></a>00399       <a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a> = 0.1;
<a name="l00400"></a>00400       <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;pitch(Radian(<a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a>));
<a name="l00401"></a>00401       <span class="keywordflow">break</span>;
<a name="l00402"></a>00402     <span class="keywordflow">case</span> Qt::Key_A:
<a name="l00403"></a>00403     <span class="keywordflow">case</span> Qt::Key_Left:
<a name="l00404"></a>00404       <a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a> = -0.1;
<a name="l00405"></a>00405       <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;yaw(Radian(<a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a>));
<a name="l00406"></a>00406       <span class="keywordflow">break</span>;
<a name="l00407"></a>00407     <span class="keywordflow">case</span> Qt::Key_D:
<a name="l00408"></a>00408     <span class="keywordflow">case</span> Qt::Key_Right:
<a name="l00409"></a>00409       <a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a> = 0.1;
<a name="l00410"></a>00410       <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;yaw(Radian(<a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a>));
<a name="l00411"></a>00411       <span class="keywordflow">break</span>;
<a name="l00412"></a>00412     }
<a name="l00413"></a>00413   }
<a name="l00414"></a>00414 }
<a name="l00415"></a>00415 
<a name="l00421"></a><a class="code" href="classOgreView.html#7554560ea144cc710b348828af29f4e5">00421</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#7554560ea144cc710b348828af29f4e5">OgreView::keyReleaseEvent</a>(QKeyEvent* evt){
<a name="l00422"></a>00422   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a> != NULL &amp;&amp; <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a> != NULL){
<a name="l00423"></a>00423     <span class="keywordflow">switch</span>(evt-&gt;key()){
<a name="l00424"></a>00424     <span class="keywordflow">case</span> Qt::Key_W:
<a name="l00425"></a>00425     <span class="keywordflow">case</span> Qt::Key_Up:
<a name="l00426"></a>00426       <a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a> = 0.0;
<a name="l00427"></a>00427       <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;pitch(Radian(<a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a>));
<a name="l00428"></a>00428       <span class="keywordflow">break</span>;
<a name="l00429"></a>00429     <span class="keywordflow">case</span> Qt::Key_S:
<a name="l00430"></a>00430     <span class="keywordflow">case</span> Qt::Key_Down:
<a name="l00431"></a>00431       <a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a> = 0.0;
<a name="l00432"></a>00432       <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;pitch(Radian(<a class="code" href="classOgreView.html#327c682b78610bfde2f9661c13ead5ca">rotX</a>));
<a name="l00433"></a>00433       <span class="keywordflow">break</span>;
<a name="l00434"></a>00434     <span class="keywordflow">case</span> Qt::Key_A:
<a name="l00435"></a>00435     <span class="keywordflow">case</span> Qt::Key_Left:
<a name="l00436"></a>00436       <a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a> = 0.0;
<a name="l00437"></a>00437       <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;yaw(Radian(<a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a>));
<a name="l00438"></a>00438       <span class="keywordflow">break</span>;
<a name="l00439"></a>00439     <span class="keywordflow">case</span> Qt::Key_D:
<a name="l00440"></a>00440     <span class="keywordflow">case</span> Qt::Key_Right:
<a name="l00441"></a>00441       <a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a> = 0.0;
<a name="l00442"></a>00442       <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;yaw(Radian(<a class="code" href="classOgreView.html#2e164e00a2e07fd902b0704167a5bf26">rotY</a>));
<a name="l00443"></a>00443       <span class="keywordflow">break</span>;
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445   }
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 
<a name="l00453"></a><a class="code" href="classOgreView.html#54956535be1cf4004ad6ac3f19347d84">00453</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#54956535be1cf4004ad6ac3f19347d84">OgreView::mousePressEvent</a>(QMouseEvent* evt){
<a name="l00454"></a>00454   <span class="keywordflow">if</span>(evt-&gt;button() == Qt::LeftButton)
<a name="l00455"></a>00455     <a class="code" href="classOgreView.html#98d89fbe8c56e5c3b0eebe6dedc9dc38">mouseLeftPressed</a> = <span class="keyword">true</span>;
<a name="l00456"></a>00456   <span class="keywordflow">if</span>(evt-&gt;button() == Qt::RightButton){
<a name="l00457"></a>00457     <a class="code" href="classOgreView.html#464d4de70fc5da6da7be73a99ede23e2">mouseRightPressed</a> = <span class="keyword">true</span>;
<a name="l00458"></a>00458     <a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a> = evt-&gt;pos();
<a name="l00459"></a>00459   }
<a name="l00460"></a>00460   <span class="keywordflow">if</span>(evt-&gt;button() == Qt::MidButton)
<a name="l00461"></a>00461     <a class="code" href="classOgreView.html#b4fa20a1236991778391bd811fb01c18">mouseMiddleBtn</a> = <span class="keyword">true</span>;
<a name="l00462"></a>00462 
<a name="l00463"></a>00463   <a class="code" href="classOgreView.html#d7371cc579784d1fbbf1dc37ceb0dc2a">mouseTimer</a>-&gt;reset();
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00471"></a><a class="code" href="classOgreView.html#dcbe99e3970580a58960e59fbb012932">00471</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#dcbe99e3970580a58960e59fbb012932">OgreView::mouseReleaseEvent</a>(QMouseEvent* evt){
<a name="l00472"></a>00472   Q_UNUSED(evt);
<a name="l00473"></a>00473   <a class="code" href="classOgreView.html#98d89fbe8c56e5c3b0eebe6dedc9dc38">mouseLeftPressed</a> = <span class="keyword">false</span>;
<a name="l00474"></a>00474   <a class="code" href="classOgreView.html#464d4de70fc5da6da7be73a99ede23e2">mouseRightPressed</a> = <span class="keyword">false</span>;
<a name="l00475"></a>00475   <a class="code" href="classOgreView.html#b4fa20a1236991778391bd811fb01c18">mouseMiddleBtn</a> = <span class="keyword">false</span>;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   <span class="keywordtype">int</span> i=<a class="code" href="classOgreView.html#d7371cc579784d1fbbf1dc37ceb0dc2a">mouseTimer</a>-&gt;getMilliseconds();
<a name="l00478"></a>00478   LOGI(<span class="stringliteral">"A button was released"</span>);
<a name="l00479"></a>00479   LOGCATS(<span class="stringliteral">"Time elapsed since last mouse press event :"</span>);
<a name="l00480"></a>00480   LOGCATI(i);
<a name="l00481"></a>00481   LOGCATS(<span class="stringliteral">" milliseconds"</span>);
<a name="l00482"></a>00482   LOGCAT();
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   <span class="keywordflow">if</span> (i&lt;<a class="code" href="classOgreView.html#40205d0d424230a550ec15f6a2316e18">msClickTime</a>){
<a name="l00485"></a>00485     LOGI(<span class="stringliteral">"This is a mouse click"</span>);
<a name="l00486"></a>00486     <a class="code" href="classOgreView.html#c0e311cf86e376476f5db9fb2082b497">selectObject</a>(evt);
<a name="l00487"></a>00487   }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 }
<a name="l00490"></a>00490 
<a name="l00496"></a><a class="code" href="classOgreView.html#a6ef4059ab668af8886cfe370bab4828">00496</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#a6ef4059ab668af8886cfe370bab4828">OgreView::mouseMoveEvent</a>(QMouseEvent* evt){
<a name="l00497"></a>00497   <span class="keywordtype">float</span> dirScale=4.0f;
<a name="l00498"></a>00498   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#b4fa20a1236991778391bd811fb01c18">mouseMiddleBtn</a> || <a class="code" href="classOgreView.html#98d89fbe8c56e5c3b0eebe6dedc9dc38">mouseLeftPressed</a>){
<a name="l00499"></a>00499     QPoint currentPos = evt-&gt;pos();
<a name="l00500"></a>00500     
<a name="l00501"></a>00501     <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a>.x() &lt; currentPos.x())
<a name="l00502"></a>00502       <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>.x = dirScale;
<a name="l00503"></a>00503     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a>.x() &gt; currentPos.x())
<a name="l00504"></a>00504       <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>.x = -dirScale;
<a name="l00505"></a>00505     <span class="keywordflow">else</span>
<a name="l00506"></a>00506       <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>.x = 0;
<a name="l00507"></a>00507     
<a name="l00508"></a>00508     <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a>.y() &lt; currentPos.y())
<a name="l00509"></a>00509       <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>.y = -dirScale;
<a name="l00510"></a>00510     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a>.y() &gt; currentPos.y())
<a name="l00511"></a>00511       <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>.y = dirScale;
<a name="l00512"></a>00512     <span class="keywordflow">else</span>
<a name="l00513"></a>00513       <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>.y = 0;
<a name="l00514"></a>00514     
<a name="l00515"></a>00515     <a class="code" href="classOgreView.html#4dd888fcc5553c51cb50e375380aec69">update</a>();
<a name="l00516"></a>00516     <a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a> = currentPos;
<a name="l00517"></a>00517     <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a> = Vector3::ZERO;
<a name="l00518"></a>00518   }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520   <span class="keywordtype">float</span> moveScale=0.04f;
<a name="l00521"></a>00521   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#464d4de70fc5da6da7be73a99ede23e2">mouseRightPressed</a>){
<a name="l00522"></a>00522     QPoint currentPos = evt-&gt;pos();
<a name="l00523"></a>00523     
<a name="l00524"></a>00524     <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a>.x() &lt; currentPos.x())
<a name="l00525"></a>00525       <a class="code" href="classOgreView.html#b66bcbe83c54d01f6adbf274c0202b7f">angleX</a> = -moveScale;
<a name="l00526"></a>00526     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a>.x() &gt; currentPos.x())
<a name="l00527"></a>00527       <a class="code" href="classOgreView.html#b66bcbe83c54d01f6adbf274c0202b7f">angleX</a> = moveScale;
<a name="l00528"></a>00528     <span class="keywordflow">else</span>
<a name="l00529"></a>00529       <a class="code" href="classOgreView.html#b66bcbe83c54d01f6adbf274c0202b7f">angleX</a> = 0.00;
<a name="l00530"></a>00530     
<a name="l00531"></a>00531     <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a>.y() &lt; currentPos.y())
<a name="l00532"></a>00532       <a class="code" href="classOgreView.html#d9bb889c7bec1d6f4f59c9e71c2e3023">angleY</a> = -moveScale;
<a name="l00533"></a>00533     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a>.y() &gt; currentPos.y())
<a name="l00534"></a>00534       <a class="code" href="classOgreView.html#d9bb889c7bec1d6f4f59c9e71c2e3023">angleY</a> = moveScale;
<a name="l00535"></a>00535     <span class="keywordflow">else</span>
<a name="l00536"></a>00536       <a class="code" href="classOgreView.html#d9bb889c7bec1d6f4f59c9e71c2e3023">angleY</a> = 0.00;
<a name="l00537"></a>00537     
<a name="l00538"></a>00538     <a class="code" href="classOgreView.html#4dd888fcc5553c51cb50e375380aec69">update</a>();
<a name="l00539"></a>00539     <a class="code" href="classOgreView.html#08fafcdecbcb0d8d6856d13f1f755cfc">mousePos</a> = currentPos;
<a name="l00540"></a>00540     <a class="code" href="classOgreView.html#b66bcbe83c54d01f6adbf274c0202b7f">angleX</a> = 0.00;
<a name="l00541"></a>00541     <a class="code" href="classOgreView.html#d9bb889c7bec1d6f4f59c9e71c2e3023">angleY</a> = 0.00;
<a name="l00542"></a>00542   }
<a name="l00543"></a>00543   <span class="comment">//if(mouseLeftPressed){</span>
<a name="l00544"></a>00544   <span class="comment">//    QPoint currentPos = evt-&gt;pos();</span>
<a name="l00545"></a>00545   
<a name="l00546"></a>00546   <span class="comment">//    if(mousePos.x() &lt; currentPos.x())</span>
<a name="l00547"></a>00547   <span class="comment">//            mDirection.x = -0.01;</span>
<a name="l00548"></a>00548   <span class="comment">//    else if(mousePos.x() &gt; currentPos.x())</span>
<a name="l00549"></a>00549   <span class="comment">//            mDirection.x = 0.01;</span>
<a name="l00550"></a>00550   <span class="comment">//    else</span>
<a name="l00551"></a>00551   <span class="comment">//            mDirection.x = 0;</span>
<a name="l00552"></a>00552   <span class="comment">//</span>
<a name="l00553"></a>00553   <span class="comment">//    update();</span>
<a name="l00554"></a>00554   <span class="comment">//    mousePos = currentPos;</span>
<a name="l00555"></a>00555   <span class="comment">//    mDirection = Vector3::ZERO;</span>
<a name="l00556"></a>00556   <span class="comment">//}</span>
<a name="l00557"></a>00557   <span class="comment">//if(mouseRightPressed){</span>
<a name="l00558"></a>00558   <span class="comment">//       QPoint currentPos = evt-&gt;pos();</span>
<a name="l00559"></a>00559   
<a name="l00560"></a>00560   <span class="comment">//    if(mousePos.x() &lt; currentPos.x())</span>
<a name="l00561"></a>00561   <span class="comment">//            mDirection.x = -0.01;</span>
<a name="l00562"></a>00562   <span class="comment">//    else if(mousePos.x() &gt; currentPos.x())</span>
<a name="l00563"></a>00563   <span class="comment">//            mDirection.x = 0.01;</span>
<a name="l00564"></a>00564   <span class="comment">//    else</span>
<a name="l00565"></a>00565   <span class="comment">//            mDirection.x = 0;</span>
<a name="l00566"></a>00566   
<a name="l00567"></a>00567   <span class="comment">//    if(mousePos.y() &lt; currentPos.y())</span>
<a name="l00568"></a>00568   <span class="comment">//            mDirection.y = -0.01;</span>
<a name="l00569"></a>00569   <span class="comment">//    else if(mousePos.y() &gt; currentPos.y())</span>
<a name="l00570"></a>00570   <span class="comment">//            mDirection.y = 0.01;</span>
<a name="l00571"></a>00571   <span class="comment">//    else</span>
<a name="l00572"></a>00572   <span class="comment">//            mDirection.y = 0;</span>
<a name="l00573"></a>00573   
<a name="l00574"></a>00574   <span class="comment">//    mousePos = currentPos;</span>
<a name="l00575"></a>00575   <span class="comment">//       update();</span>
<a name="l00576"></a>00576   <span class="comment">//    mDirection = Vector3::ZERO;</span>
<a name="l00577"></a>00577   <span class="comment">//}</span>
<a name="l00578"></a>00578 }
<a name="l00579"></a>00579 
<a name="l00585"></a><a class="code" href="classOgreView.html#e0e907416b01d7d4152b75896ea5fbac">00585</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#e0e907416b01d7d4152b75896ea5fbac">OgreView::wheelEvent</a>(QWheelEvent* evt){
<a name="l00586"></a>00586   <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>.z = -evt-&gt;delta();
<a name="l00587"></a>00587   <a class="code" href="classOgreView.html#4dd888fcc5553c51cb50e375380aec69">update</a>();
<a name="l00588"></a>00588   <a class="code" href="classOgreView.html#b3cc7b918e7d6ef29b5bce4ad2888a0a">mDirection</a>.z = 0;
<a name="l00589"></a>00589 }
<a name="l00590"></a>00590 
<a name="l00596"></a><a class="code" href="classOgreView.html#1d0afddffbdf8c6bf7cf85e6b09c0e34">00596</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#1d0afddffbdf8c6bf7cf85e6b09c0e34">OgreView::addObject</a>(Ogre::String name){
<a name="l00597"></a>00597   LOGI(<span class="stringliteral">"Adding object :"</span>);
<a name="l00598"></a>00598   LOGCATS(<span class="stringliteral">"Object name :"</span>);
<a name="l00599"></a>00599   LOGCATS(name.c_str());
<a name="l00600"></a>00600   LOGCAT();
<a name="l00601"></a>00601   <span class="comment">//Update the name</span>
<a name="l00602"></a>00602   String meshName = name;
<a name="l00603"></a>00603   meshName.substr(meshName.size()-5, 5);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605   <span class="comment">//Remove old object</span>
<a name="l00606"></a>00606   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a> != NULL){
<a name="l00607"></a>00607     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;destroyEntity(<a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>);
<a name="l00608"></a>00608     <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a> = 0;
<a name="l00609"></a>00609   }
<a name="l00610"></a>00610   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a> != NULL)
<a name="l00611"></a>00611     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;destroySceneNode(<a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;getName());
<a name="l00612"></a>00612 
<a name="l00613"></a>00613   <span class="comment">//Add New Object</span>
<a name="l00614"></a>00614   <a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a> = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;createEntity(meshName, name);
<a name="l00615"></a>00615   <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a> = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getRootSceneNode()
<a name="l00616"></a>00616     -&gt;createChildSceneNode(meshName+<span class="stringliteral">"node"</span>);
<a name="l00617"></a>00617 
<a name="l00618"></a>00618   <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;attachObject(<a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>);
<a name="l00619"></a>00619   <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;setPosition(Vector3(0, 0, 0));
<a name="l00620"></a>00620 
<a name="l00621"></a>00621   <span class="comment">//Update the camera's pos to fit whith the object size</span>
<a name="l00622"></a>00622   <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;setPosition(<a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;getPosition().x, 
<a name="l00623"></a>00623                        <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;getPosition().y, 
<a name="l00624"></a>00624                        <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;getPosition().z - 200);
<a name="l00625"></a>00625   <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;lookAt(<a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;getPosition());
<a name="l00626"></a>00626   LOGI(<span class="stringliteral">"Object correctly added"</span>);
<a name="l00627"></a>00627 }
<a name="l00628"></a>00628 
<a name="l00634"></a><a class="code" href="classOgreView.html#5ff32bf8759f66a7d354af26bb2bfa0a">00634</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#5ff32bf8759f66a7d354af26bb2bfa0a">OgreView::setFog</a>(<span class="keywordtype">int</span> fogType){
<a name="l00635"></a>00635   <span class="keywordflow">switch</span>(fogType){
<a name="l00636"></a>00636   <span class="keywordflow">case</span> 0:
<a name="l00637"></a>00637     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setFog(FOG_NONE);
<a name="l00638"></a>00638     <span class="keywordflow">break</span>;
<a name="l00639"></a>00639   <span class="keywordflow">case</span> 1:
<a name="l00640"></a>00640     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setFog(FOG_LINEAR, <a class="code" href="classOgreView.html#47562d65ee20d942bdd017cf2481a668">fogColor</a>, 0.0, 50, 500);
<a name="l00641"></a>00641     <span class="keywordflow">break</span>;
<a name="l00642"></a>00642   <span class="keywordflow">case</span> 2:
<a name="l00643"></a>00643     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setFog(FOG_EXP, <a class="code" href="classOgreView.html#47562d65ee20d942bdd017cf2481a668">fogColor</a>, 0.005);
<a name="l00644"></a>00644     <span class="keywordflow">break</span>;
<a name="l00645"></a>00645   <span class="keywordflow">case</span> 3:
<a name="l00646"></a>00646     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setFog(FOG_EXP2, <a class="code" href="classOgreView.html#47562d65ee20d942bdd017cf2481a668">fogColor</a>, 0.003);
<a name="l00647"></a>00647     <span class="keywordflow">break</span>;
<a name="l00648"></a>00648   }
<a name="l00649"></a>00649 }
<a name="l00650"></a>00650 
<a name="l00656"></a><a class="code" href="classOgreView.html#f2f323f4014cbe8c86e6786f27e036ee">00656</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#f2f323f4014cbe8c86e6786f27e036ee">OgreView::setFogColor</a>(QColor color){
<a name="l00657"></a>00657   <a class="code" href="classOgreView.html#b6affcb1471f9f3d2b0fe94e380fefdd">fogOldColor</a> = color;
<a name="l00658"></a>00658   <a class="code" href="classOgreView.html#47562d65ee20d942bdd017cf2481a668">fogColor</a>.setAsARGB(color.rgba());
<a name="l00659"></a>00659   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getFogMode() == FOG_LINEAR)
<a name="l00660"></a>00660     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setFog(FOG_LINEAR, <a class="code" href="classOgreView.html#47562d65ee20d942bdd017cf2481a668">fogColor</a>, <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getFogDensity(), 
<a name="l00661"></a>00661                       <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getFogStart(), <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getFogEnd());
<a name="l00662"></a>00662 
<a name="l00663"></a>00663   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getFogMode() == FOG_EXP)
<a name="l00664"></a>00664     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setFog(FOG_EXP, <a class="code" href="classOgreView.html#47562d65ee20d942bdd017cf2481a668">fogColor</a>, <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getFogDensity());
<a name="l00665"></a>00665 
<a name="l00666"></a>00666   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getFogMode() == FOG_EXP2)
<a name="l00667"></a>00667     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setFog(FOG_EXP2, <a class="code" href="classOgreView.html#47562d65ee20d942bdd017cf2481a668">fogColor</a>, <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getFogDensity());
<a name="l00668"></a>00668 }
<a name="l00669"></a>00669 
<a name="l00675"></a><a class="code" href="classOgreView.html#0379e325c6189ab22de4ae1d5252bdd4">00675</a> QColor <a class="code" href="classOgreView.html#0379e325c6189ab22de4ae1d5252bdd4">OgreView::getFogColor</a>(){
<a name="l00676"></a>00676   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#b6affcb1471f9f3d2b0fe94e380fefdd">fogOldColor</a>;
<a name="l00677"></a>00677 }
<a name="l00678"></a>00678 
<a name="l00684"></a><a class="code" href="classOgreView.html#c5a473f833b114d9c4bc89db9199b460">00684</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#c5a473f833b114d9c4bc89db9199b460">OgreView::setBackgroundColor</a>(QColor color){
<a name="l00685"></a>00685   <a class="code" href="classOgreView.html#739822518f8341a34b67a8e0c6d8600f">backgroundOldColor</a> = color;
<a name="l00686"></a>00686   <a class="code" href="classOgreView.html#0af2a60bcf255f1aa0a59930471af997">backgroundColor</a>.setAsARGB(color.rgba());
<a name="l00687"></a>00687   <a class="code" href="classOgreView.html#71eb32d803b181331b017acf36cb4e6b">mVp</a>-&gt;setBackgroundColour(<a class="code" href="classOgreView.html#0af2a60bcf255f1aa0a59930471af997">backgroundColor</a>);
<a name="l00688"></a>00688 }
<a name="l00689"></a>00689 
<a name="l00695"></a><a class="code" href="classOgreView.html#6de6432191a9f9d103c570352f0afce6">00695</a> QColor <a class="code" href="classOgreView.html#6de6432191a9f9d103c570352f0afce6">OgreView::getBackgroundColor</a>(){
<a name="l00696"></a>00696   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#739822518f8341a34b67a8e0c6d8600f">backgroundOldColor</a>;
<a name="l00697"></a>00697 }
<a name="l00698"></a>00698 
<a name="l00704"></a><a class="code" href="classOgreView.html#0844e366ce3e37933a9eb779e0022859">00704</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#0844e366ce3e37933a9eb779e0022859">OgreView::setShadow</a>(<span class="keywordtype">int</span> shadowType){
<a name="l00705"></a>00705   <span class="keywordflow">if</span>(shadowType == 0)
<a name="l00706"></a>00706     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setShadowTechnique(SHADOWTYPE_NONE);
<a name="l00707"></a>00707   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(shadowType == 1)
<a name="l00708"></a>00708     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setShadowTechnique(SHADOWTYPE_STENCIL_MODULATIVE);
<a name="l00709"></a>00709   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(shadowType == 2)
<a name="l00710"></a>00710     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setShadowTechnique(SHADOWTYPE_STENCIL_ADDITIVE);
<a name="l00711"></a>00711   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(shadowType == 3)
<a name="l00712"></a>00712     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setShadowTechnique(SHADOWTYPE_TEXTURE_MODULATIVE);
<a name="l00713"></a>00713 }
<a name="l00714"></a>00714 
<a name="l00720"></a><a class="code" href="classOgreView.html#72fbf9e85a43f65e6874970d52494027">00720</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#72fbf9e85a43f65e6874970d52494027">OgreView::setAmbientLight</a>(QColor color){
<a name="l00721"></a>00721   <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;setAmbientLight(ColourValue(color.redF(), color.greenF(), 
<a name="l00722"></a>00722                                          color.blueF(), color.alphaF()));
<a name="l00723"></a>00723 
<a name="l00724"></a>00724   <a class="code" href="classOgreView.html#2625c6486339b15fb44e2a01ac97e365">ambientOldColor</a> = color;
<a name="l00725"></a>00725 }
<a name="l00726"></a>00726 
<a name="l00732"></a><a class="code" href="classOgreView.html#6ea863ab391d881f2978aaada7c38b3e">00732</a> QColor <a class="code" href="classOgreView.html#6ea863ab391d881f2978aaada7c38b3e">OgreView::getAmbientLight</a>(){
<a name="l00733"></a>00733   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#2625c6486339b15fb44e2a01ac97e365">ambientOldColor</a>;
<a name="l00734"></a>00734 }
<a name="l00735"></a>00735 
<a name="l00741"></a><a class="code" href="classOgreView.html#725b2f8fc7a89c1c5dd02e3e182647f6">00741</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#725b2f8fc7a89c1c5dd02e3e182647f6">OgreView::setDiffuseColor</a>(QColor color){
<a name="l00742"></a>00742   <a class="code" href="classOgreView.html#e6b9bee14e41b9f3660aad3a70c28db5">diffuseOldColor</a> = color;
<a name="l00743"></a>00743 }
<a name="l00744"></a>00744 
<a name="l00750"></a><a class="code" href="classOgreView.html#7a69c4d95618ef2d3e5285f605a53a46">00750</a> QColor <a class="code" href="classOgreView.html#7a69c4d95618ef2d3e5285f605a53a46">OgreView::getDiffuseColor</a>(){
<a name="l00751"></a>00751   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#e6b9bee14e41b9f3660aad3a70c28db5">diffuseOldColor</a>;
<a name="l00752"></a>00752 }
<a name="l00753"></a>00753 
<a name="l00759"></a><a class="code" href="classOgreView.html#48b7581209e68d4a04a47b3c1ab48496">00759</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#48b7581209e68d4a04a47b3c1ab48496">OgreView::setSpecularColor</a>(QColor color){
<a name="l00760"></a>00760   <a class="code" href="classOgreView.html#75fc22923f2551b13066f67c72ac481b">specularOldColor</a> = color;
<a name="l00761"></a>00761 }
<a name="l00762"></a>00762 
<a name="l00768"></a><a class="code" href="classOgreView.html#9801e0e38754bbaaf8d75c40817fc54a">00768</a> QColor <a class="code" href="classOgreView.html#9801e0e38754bbaaf8d75c40817fc54a">OgreView::getSpecularColor</a>(){
<a name="l00769"></a>00769   <span class="keywordflow">return</span> <a class="code" href="classOgreView.html#75fc22923f2551b13066f67c72ac481b">specularOldColor</a>;
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 
<a name="l00782"></a><a class="code" href="classOgreView.html#47528032ce7f26d8a9e71fef63c91861">00782</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#47528032ce7f26d8a9e71fef63c91861">OgreView::createPointLight</a>(Ogre::String name, Ogre::String xPos, 
<a name="l00783"></a>00783         Ogre::String yPos, Ogre::String zPos, Ogre::String diffuse, 
<a name="l00784"></a>00784         Ogre::String specular)
<a name="l00785"></a>00785 {
<a name="l00786"></a>00786 
<a name="l00787"></a>00787   Light* newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;createLight(name);
<a name="l00788"></a>00788   newLight-&gt;setPosition(StringConverter::parseReal(xPos), 
<a name="l00789"></a>00789                         StringConverter::parseReal(yPos), 
<a name="l00790"></a>00790                         StringConverter::parseReal(zPos));
<a name="l00791"></a>00791 
<a name="l00792"></a>00792   QColor diffuseColor(diffuse.c_str());
<a name="l00793"></a>00793   QColor specularColor(specular.c_str());
<a name="l00794"></a>00794   <a class="code" href="classOgreView.html#99859abd49bde56673db9b53c275c9a6">lightDiffuseColor</a>.setAsRGBA(diffuseColor.rgba());
<a name="l00795"></a>00795   <a class="code" href="classOgreView.html#fbe254e16705a0511e256ba31b7d9eff">lightSpecularColor</a>.setAsRGBA(specularColor.rgba());
<a name="l00796"></a>00796   <a class="code" href="classOgreView.html#e6b9bee14e41b9f3660aad3a70c28db5">diffuseOldColor</a> = diffuseColor;
<a name="l00797"></a>00797   <a class="code" href="classOgreView.html#75fc22923f2551b13066f67c72ac481b">specularOldColor</a> = specularColor;
<a name="l00798"></a>00798   newLight-&gt;setDiffuseColour(diffuseColor.redF(), diffuseColor.greenF(), 
<a name="l00799"></a>00799                              diffuseColor.blueF());
<a name="l00800"></a>00800   newLight-&gt;setSpecularColour(specularColor.redF(), specularColor.greenF(), 
<a name="l00801"></a>00801                               specularColor.blueF());
<a name="l00802"></a>00802 }
<a name="l00803"></a>00803 
<a name="l00814"></a><a class="code" href="classOgreView.html#6dfb4613ec86f02ebf90e6f99b1ffbf6">00814</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#6dfb4613ec86f02ebf90e6f99b1ffbf6">OgreView::createDirectionalLight</a>(Ogre::String name, Ogre::String xDir, 
<a name="l00815"></a>00815         Ogre::String yDir, Ogre::String zDir, Ogre::String diffuse, 
<a name="l00816"></a>00816         Ogre::String specular)
<a name="l00817"></a>00817 {
<a name="l00818"></a>00818 
<a name="l00819"></a>00819   Light* newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;createLight(name);
<a name="l00820"></a>00820   newLight-&gt;setDirection(StringConverter::parseReal(xDir), 
<a name="l00821"></a>00821                          StringConverter::parseReal(yDir), 
<a name="l00822"></a>00822                          StringConverter::parseReal(zDir));
<a name="l00823"></a>00823 
<a name="l00824"></a>00824   QColor diffuseColor(diffuse.c_str());
<a name="l00825"></a>00825   QColor specularColor(specular.c_str());
<a name="l00826"></a>00826   <a class="code" href="classOgreView.html#99859abd49bde56673db9b53c275c9a6">lightDiffuseColor</a>.setAsRGBA(diffuseColor.rgba());
<a name="l00827"></a>00827   <a class="code" href="classOgreView.html#fbe254e16705a0511e256ba31b7d9eff">lightSpecularColor</a>.setAsRGBA(specularColor.rgba());
<a name="l00828"></a>00828   <a class="code" href="classOgreView.html#e6b9bee14e41b9f3660aad3a70c28db5">diffuseOldColor</a> = diffuseColor;
<a name="l00829"></a>00829   <a class="code" href="classOgreView.html#75fc22923f2551b13066f67c72ac481b">specularOldColor</a> = specularColor;
<a name="l00830"></a>00830   newLight-&gt;setDiffuseColour(diffuseColor.redF(), diffuseColor.greenF(), 
<a name="l00831"></a>00831                              diffuseColor.blueF());
<a name="l00832"></a>00832 
<a name="l00833"></a>00833   newLight-&gt;setSpecularColour(specularColor.redF(), specularColor.greenF(), 
<a name="l00834"></a>00834                               specularColor.blueF());
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00850"></a><a class="code" href="classOgreView.html#96eee5e0eb03c4a47c87f0a71596dc64">00850</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#96eee5e0eb03c4a47c87f0a71596dc64">OgreView::createSpotlight</a>(Ogre::String name, Ogre::String xPos, 
<a name="l00851"></a>00851         Ogre::String yPos, Ogre::String zPos, Ogre::String xDir, 
<a name="l00852"></a>00852         Ogre::String yDir, Ogre::String zDir, Ogre::String diffuse, 
<a name="l00853"></a>00853         Ogre::String specular)
<a name="l00854"></a>00854 {
<a name="l00855"></a>00855 
<a name="l00856"></a>00856   Light* newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;createLight(name);
<a name="l00857"></a>00857   newLight-&gt;setPosition(StringConverter::parseReal(xPos), 
<a name="l00858"></a>00858                         StringConverter::parseReal(yPos), 
<a name="l00859"></a>00859                         StringConverter::parseReal(zPos));
<a name="l00860"></a>00860 
<a name="l00861"></a>00861   newLight-&gt;setDirection(StringConverter::parseReal(xDir), 
<a name="l00862"></a>00862                          StringConverter::parseReal(yDir), 
<a name="l00863"></a>00863                          StringConverter::parseReal(zDir));
<a name="l00864"></a>00864   
<a name="l00865"></a>00865   QColor diffuseColor(diffuse.c_str());
<a name="l00866"></a>00866   QColor specularColor(specular.c_str());
<a name="l00867"></a>00867   <a class="code" href="classOgreView.html#99859abd49bde56673db9b53c275c9a6">lightDiffuseColor</a>.setAsRGBA(diffuseColor.rgba());
<a name="l00868"></a>00868   <a class="code" href="classOgreView.html#fbe254e16705a0511e256ba31b7d9eff">lightSpecularColor</a>.setAsRGBA(specularColor.rgba());
<a name="l00869"></a>00869   <a class="code" href="classOgreView.html#e6b9bee14e41b9f3660aad3a70c28db5">diffuseOldColor</a> = diffuseColor;
<a name="l00870"></a>00870   <a class="code" href="classOgreView.html#75fc22923f2551b13066f67c72ac481b">specularOldColor</a> = specularColor;
<a name="l00871"></a>00871   newLight-&gt;setDiffuseColour(diffuseColor.redF(), diffuseColor.greenF(), 
<a name="l00872"></a>00872                              diffuseColor.blueF());
<a name="l00873"></a>00873 
<a name="l00874"></a>00874   newLight-&gt;setSpecularColour(specularColor.redF(), specularColor.greenF(), 
<a name="l00875"></a>00875                               specularColor.blueF());
<a name="l00876"></a>00876 }
<a name="l00877"></a>00877 
<a name="l00889"></a><a class="code" href="classOgreView.html#25a70ffca8111822c11fdf1311d784fb">00889</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#25a70ffca8111822c11fdf1311d784fb">OgreView::updatePointLight</a>(Ogre::String oldName, Ogre::String name, 
<a name="l00890"></a>00890         Ogre::String xPos, Ogre::String yPos, Ogre::String zPos, 
<a name="l00891"></a>00891         Ogre::String diffuse, Ogre::String specular)
<a name="l00892"></a>00892 {
<a name="l00893"></a>00893 
<a name="l00894"></a>00894   Light* newLight = NULL;
<a name="l00895"></a>00895 
<a name="l00896"></a>00896   <span class="comment">//name has changed</span>
<a name="l00897"></a>00897   <span class="keywordflow">if</span>(oldName != <span class="stringliteral">"none"</span>){
<a name="l00898"></a>00898     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;destroyLight(oldName);
<a name="l00899"></a>00899     newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;createLight(name);
<a name="l00900"></a>00900   }
<a name="l00901"></a>00901   <span class="keywordflow">else</span>
<a name="l00902"></a>00902     newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getLight(name);
<a name="l00903"></a>00903   
<a name="l00904"></a>00904   newLight-&gt;setPosition(StringConverter::parseReal(xPos), 
<a name="l00905"></a>00905                         StringConverter::parseReal(yPos), 
<a name="l00906"></a>00906                         StringConverter::parseReal(zPos));
<a name="l00907"></a>00907 
<a name="l00908"></a>00908   QColor diffuseColor(diffuse.c_str());
<a name="l00909"></a>00909   QColor specularColor(specular.c_str());
<a name="l00910"></a>00910   <a class="code" href="classOgreView.html#99859abd49bde56673db9b53c275c9a6">lightDiffuseColor</a>.setAsRGBA(diffuseColor.rgba());
<a name="l00911"></a>00911   <a class="code" href="classOgreView.html#fbe254e16705a0511e256ba31b7d9eff">lightSpecularColor</a>.setAsRGBA(specularColor.rgba());
<a name="l00912"></a>00912   <a class="code" href="classOgreView.html#e6b9bee14e41b9f3660aad3a70c28db5">diffuseOldColor</a> = diffuseColor;
<a name="l00913"></a>00913   <a class="code" href="classOgreView.html#75fc22923f2551b13066f67c72ac481b">specularOldColor</a> = specularColor;
<a name="l00914"></a>00914   newLight-&gt;setDiffuseColour(diffuseColor.redF(), diffuseColor.greenF(), 
<a name="l00915"></a>00915                              diffuseColor.blueF());
<a name="l00916"></a>00916 
<a name="l00917"></a>00917   newLight-&gt;setSpecularColour(specularColor.redF(), specularColor.greenF(), 
<a name="l00918"></a>00918                               specularColor.blueF());
<a name="l00919"></a>00919 }
<a name="l00920"></a>00920 
<a name="l00932"></a><a class="code" href="classOgreView.html#658138aa6f9f5bad2790e858f6196015">00932</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#658138aa6f9f5bad2790e858f6196015">OgreView::updateDirectionalLight</a>(Ogre::String oldName, Ogre::String name, 
<a name="l00933"></a>00933       Ogre::String xDir, Ogre::String yDir, Ogre::String zDir, 
<a name="l00934"></a>00934       Ogre::String diffuse, Ogre::String specular)
<a name="l00935"></a>00935 {
<a name="l00936"></a>00936 
<a name="l00937"></a>00937   Light* newLight = NULL;
<a name="l00938"></a>00938 
<a name="l00939"></a>00939   <span class="comment">//name has changed</span>
<a name="l00940"></a>00940   <span class="keywordflow">if</span>(oldName != <span class="stringliteral">"none"</span>){
<a name="l00941"></a>00941     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;destroyLight(oldName);
<a name="l00942"></a>00942     newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;createLight(name);
<a name="l00943"></a>00943   }
<a name="l00944"></a>00944   <span class="keywordflow">else</span>
<a name="l00945"></a>00945     newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getLight(name);
<a name="l00946"></a>00946   
<a name="l00947"></a>00947   newLight-&gt;setDirection(StringConverter::parseReal(xDir), StringConverter::parseReal(yDir), StringConverter::parseReal(zDir));
<a name="l00948"></a>00948   
<a name="l00949"></a>00949   QColor diffuseColor(diffuse.c_str());
<a name="l00950"></a>00950   QColor specularColor(specular.c_str());
<a name="l00951"></a>00951   <a class="code" href="classOgreView.html#99859abd49bde56673db9b53c275c9a6">lightDiffuseColor</a>.setAsRGBA(diffuseColor.rgba());
<a name="l00952"></a>00952   <a class="code" href="classOgreView.html#fbe254e16705a0511e256ba31b7d9eff">lightSpecularColor</a>.setAsRGBA(specularColor.rgba());
<a name="l00953"></a>00953   <a class="code" href="classOgreView.html#e6b9bee14e41b9f3660aad3a70c28db5">diffuseOldColor</a> = diffuseColor;
<a name="l00954"></a>00954   <a class="code" href="classOgreView.html#75fc22923f2551b13066f67c72ac481b">specularOldColor</a> = specularColor;
<a name="l00955"></a>00955   newLight-&gt;setDiffuseColour(diffuseColor.redF(), diffuseColor.greenF(), diffuseColor.blueF());
<a name="l00956"></a>00956   newLight-&gt;setSpecularColour(specularColor.redF(), specularColor.greenF(), specularColor.blueF());
<a name="l00957"></a>00957 }
<a name="l00958"></a>00958 
<a name="l00973"></a><a class="code" href="classOgreView.html#f02c709b6ac1d8008b4681ba6b2670e6">00973</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#f02c709b6ac1d8008b4681ba6b2670e6">OgreView::updateSpotlight</a>(Ogre::String oldName, Ogre::String name, 
<a name="l00974"></a>00974        Ogre::String xPos, Ogre::String yPos, Ogre::String zPos, 
<a name="l00975"></a>00975        Ogre::String xDir, Ogre::String yDir, Ogre::String zDir, 
<a name="l00976"></a>00976        Ogre::String diffuse, Ogre::String specular)
<a name="l00977"></a>00977 {
<a name="l00978"></a>00978 
<a name="l00979"></a>00979   Light* newLight = NULL;
<a name="l00980"></a>00980   <span class="keywordflow">if</span>(oldName != <span class="stringliteral">"none"</span>){<span class="comment">//name has changed</span>
<a name="l00981"></a>00981     <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;destroyLight(oldName);
<a name="l00982"></a>00982     newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;createLight(name);
<a name="l00983"></a>00983   }
<a name="l00984"></a>00984   <span class="keywordflow">else</span>
<a name="l00985"></a>00985     newLight = <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;getLight(name);
<a name="l00986"></a>00986 
<a name="l00987"></a>00987   newLight-&gt;setPosition(StringConverter::parseReal(xPos), StringConverter::parseReal(yPos), StringConverter::parseReal(zPos));
<a name="l00988"></a>00988   newLight-&gt;setDirection(StringConverter::parseReal(xDir), StringConverter::parseReal(yDir), StringConverter::parseReal(zDir));
<a name="l00989"></a>00989   
<a name="l00990"></a>00990   QColor diffuseColor(diffuse.c_str());
<a name="l00991"></a>00991   QColor specularColor(specular.c_str());
<a name="l00992"></a>00992   <a class="code" href="classOgreView.html#99859abd49bde56673db9b53c275c9a6">lightDiffuseColor</a>.setAsRGBA(diffuseColor.rgba());
<a name="l00993"></a>00993   <a class="code" href="classOgreView.html#fbe254e16705a0511e256ba31b7d9eff">lightSpecularColor</a>.setAsRGBA(specularColor.rgba());
<a name="l00994"></a>00994   <a class="code" href="classOgreView.html#e6b9bee14e41b9f3660aad3a70c28db5">diffuseOldColor</a> = diffuseColor;
<a name="l00995"></a>00995   <a class="code" href="classOgreView.html#75fc22923f2551b13066f67c72ac481b">specularOldColor</a> = specularColor;
<a name="l00996"></a>00996   newLight-&gt;setDiffuseColour(diffuseColor.redF(), diffuseColor.greenF(), diffuseColor.blueF());
<a name="l00997"></a>00997   newLight-&gt;setSpecularColour(specularColor.redF(), specularColor.greenF(), specularColor.blueF());
<a name="l00998"></a>00998 }
<a name="l00999"></a>00999 
<a name="l01005"></a><a class="code" href="classOgreView.html#6a39fbc1481dcd445530fcbf0968cce6">01005</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#6a39fbc1481dcd445530fcbf0968cce6">OgreView::deleteLight</a>(Ogre::String name){
<a name="l01006"></a>01006   <a class="code" href="classOgreView.html#78e8c87c8a986b4d83ddf8a627eb85ea">mSceneMgr</a>-&gt;destroyLight(name);
<a name="l01007"></a>01007 }
<a name="l01008"></a>01008 
<a name="l01014"></a><a class="code" href="classOgreView.html#bb79c423d3f70d0970306357d64e6027">01014</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#bb79c423d3f70d0970306357d64e6027">OgreView::setRenderDetail</a>(<span class="keywordtype">int</span> value){
<a name="l01015"></a>01015   <span class="keywordflow">switch</span>(value){
<a name="l01016"></a>01016   <span class="keywordflow">case</span> 0:
<a name="l01017"></a>01017     <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;setPolygonMode(PM_SOLID);
<a name="l01018"></a>01018     <span class="keywordflow">break</span>;
<a name="l01019"></a>01019   <span class="keywordflow">case</span> 1:
<a name="l01020"></a>01020     <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;setPolygonMode(PM_WIREFRAME);
<a name="l01021"></a>01021     <span class="keywordflow">break</span>;
<a name="l01022"></a>01022   <span class="keywordflow">case</span> 2:
<a name="l01023"></a>01023     <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>-&gt;setPolygonMode(PM_POINTS);
<a name="l01024"></a>01024     <span class="keywordflow">break</span>;
<a name="l01025"></a>01025   }
<a name="l01026"></a>01026 }
<a name="l01027"></a>01027 
<a name="l01033"></a><a class="code" href="classOgreView.html#13649d3b166e3cea848836233d879d42">01033</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#13649d3b166e3cea848836233d879d42">OgreView::setLOD</a>(<span class="keywordtype">int</span> value){
<a name="l01034"></a>01034   <a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>-&gt;setMeshLodBias(value);
<a name="l01035"></a>01035 }
<a name="l01036"></a>01036 
<a name="l01042"></a><a class="code" href="classOgreView.html#b89260666867cd670cf8015c9d488bc9">01042</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#b89260666867cd670cf8015c9d488bc9">OgreView::setBoundingBoxes</a>(<span class="keywordtype">int</span> value){
<a name="l01043"></a>01043   <span class="keywordflow">if</span>(value)
<a name="l01044"></a>01044     <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;showBoundingBox(<span class="keyword">true</span>);
<a name="l01045"></a>01045   <span class="keywordflow">else</span>
<a name="l01046"></a>01046     <a class="code" href="classOgreView.html#ed2ca5ebcb60552a313408af84f8d043">mainNode</a>-&gt;showBoundingBox(<span class="keyword">false</span>);
<a name="l01047"></a>01047 }
<a name="l01048"></a>01048 
<a name="l01054"></a><a class="code" href="classOgreView.html#e884509ae0127b67dedf04f914c7168b">01054</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#e884509ae0127b67dedf04f914c7168b">OgreView::setSkeleton</a>(<span class="keywordtype">int</span> value){
<a name="l01055"></a>01055   <span class="keywordflow">if</span>(value)
<a name="l01056"></a>01056     <a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>-&gt;setDisplaySkeleton(<span class="keyword">true</span>);
<a name="l01057"></a>01057   <span class="keywordflow">else</span>
<a name="l01058"></a>01058     <a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>-&gt;setDisplaySkeleton(<span class="keyword">false</span>);
<a name="l01059"></a>01059 }
<a name="l01060"></a>01060 
<a name="l01064"></a><a class="code" href="classOgreView.html#aae64596a9fc6e09083b1dfbd5056a79">01064</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#aae64596a9fc6e09083b1dfbd5056a79">OgreView::updateMaterial</a>(){
<a name="l01065"></a>01065   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>-&gt;getNumSubEntities(); ++i){
<a name="l01066"></a>01066     <a class="code" href="classOgreView.html#7038312e507ac7700924fdce77ca99ef">mainSubEnt</a> = <a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>-&gt;getSubEntity(i);
<a name="l01067"></a>01067     <a class="code" href="classOgreView.html#7038312e507ac7700924fdce77ca99ef">mainSubEnt</a>-&gt;getMaterial()-&gt;reload();
<a name="l01068"></a>01068   }
<a name="l01069"></a>01069 }
<a name="l01070"></a>01070 
<a name="l01076"></a><a class="code" href="classOgreView.html#dca0f608e0d28e84834ffb57450d2f41">01076</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#dca0f608e0d28e84834ffb57450d2f41">OgreView::setAnimationState</a>(Ogre::String name){
<a name="l01077"></a>01077   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a> != NULL){
<a name="l01078"></a>01078     <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a>-&gt;setLoop(<span class="keyword">false</span>);
<a name="l01079"></a>01079     <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a>-&gt;setEnabled(<span class="keyword">false</span>);
<a name="l01080"></a>01080   }
<a name="l01081"></a>01081   <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a> = <a class="code" href="classOgreView.html#b9279a845b63485713b702729e8c1dea">mainEnt</a>-&gt;getAnimationState(name);
<a name="l01082"></a>01082   <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a>-&gt;setLoop(<span class="keyword">false</span>);
<a name="l01083"></a>01083   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#0cd84f9c7776142b607b7c14e1f8190c">isLoopOn</a>)
<a name="l01084"></a>01084     <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a>-&gt;setLoop(<span class="keyword">true</span>);
<a name="l01085"></a>01085   <span class="keywordflow">if</span>(<a class="code" href="classOgreView.html#cc9779cb4662e6b9ee9b9219a1cebc0e">isAnimEnabled</a>)
<a name="l01086"></a>01086     <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a>-&gt;setEnabled(<span class="keyword">true</span>);
<a name="l01087"></a>01087 }
<a name="l01088"></a>01088 
<a name="l01094"></a><a class="code" href="classOgreView.html#74a8c6ed729b298c16d465ee790a9b2c">01094</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#74a8c6ed729b298c16d465ee790a9b2c">OgreView::setAnimLoop</a>(<span class="keywordtype">bool</span> enable){
<a name="l01095"></a>01095   <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a>-&gt;setLoop(enable);
<a name="l01096"></a>01096   <a class="code" href="classOgreView.html#0cd84f9c7776142b607b7c14e1f8190c">isLoopOn</a> = enable;
<a name="l01097"></a>01097 }
<a name="l01098"></a>01098 
<a name="l01104"></a><a class="code" href="classOgreView.html#4a7dcfffac0e91d5e08136b79cdd901f">01104</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#4a7dcfffac0e91d5e08136b79cdd901f">OgreView::setAnimEnabled</a>(<span class="keywordtype">bool</span> enable){
<a name="l01105"></a>01105   <a class="code" href="classOgreView.html#3851a84752c63bc5d644d9972c7ae932">mainEntAnim</a>-&gt;setEnabled(enable);
<a name="l01106"></a>01106   <a class="code" href="classOgreView.html#cc9779cb4662e6b9ee9b9219a1cebc0e">isAnimEnabled</a> = enable;
<a name="l01107"></a>01107 }
<a name="l01108"></a>01108 
<a name="l01114"></a><a class="code" href="classOgreView.html#995c66a08f4a641b28c3b275920a45f8">01114</a> String <a class="code" href="classOgreView.html#995c66a08f4a641b28c3b275920a45f8">OgreView::getLog</a>(){
<a name="l01115"></a>01115   String msgLog(<a class="code" href="classOgreView.html#6dcac8e2e1bbff826d585b4450d23269">mLogListener</a>-&gt;<a class="code" href="classmyLogListener.html#72a2a613151c2f7533ce70f728853de0">getMsg</a>().toStdString() + <span class="charliteral">'\n'</span>);
<a name="l01116"></a>01116 
<a name="l01117"></a>01117   <span class="comment">//the message has been updated</span>
<a name="l01118"></a>01118   <span class="keywordflow">if</span>(msgLog != <a class="code" href="classOgreView.html#b08bbd5698d9cea317de87b5f4ed73b0">oldMsgLog</a>){
<a name="l01119"></a>01119     <span class="keywordflow">return</span> msgLog;
<a name="l01121"></a>01121     <span class="comment">// Why is this here? It never gets executed...</span>
<a name="l01123"></a>01123 <span class="comment"></span>    <span class="comment">//oldMsgLog = msgLog;</span>
<a name="l01124"></a>01124     <span class="comment">//QMessageBox::warning(this, msgLog.c_str(), oldMsgLog.c_str());</span>
<a name="l01125"></a>01125   }
<a name="l01126"></a>01126   <span class="keywordflow">else</span>
<a name="l01127"></a>01127     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
<a name="l01128"></a>01128 }
<a name="l01129"></a>01129 
<a name="l01135"></a><a class="code" href="classOgreView.html#efa1cf6cecb34d52bc987d913fb6353b">01135</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#efa1cf6cecb34d52bc987d913fb6353b">OgreView::dragEnterEvent</a>(QDragEnterEvent* evt){
<a name="l01136"></a>01136 
<a name="l01137"></a>01137 <span class="preprocessor">#if defined(Q_WS_WIN)</span>
<a name="l01138"></a>01138 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(evt-&gt;mimeData()-&gt;hasUrls()){
<a name="l01139"></a>01139     QRegExp fileMatcher(<span class="stringliteral">"^/([A-Z]:/.*\\.mesh)$"</span>);
<a name="l01140"></a>01140     <span class="keywordflow">if</span>( fileMatcher.exactMatch(evt-&gt;mimeData()-&gt;urls().first().path()) )
<a name="l01141"></a>01141       evt-&gt;acceptProposedAction();
<a name="l01142"></a>01142   }
<a name="l01143"></a>01143 <span class="preprocessor">#else</span>
<a name="l01144"></a>01144 <span class="preprocessor"></span>  QRegExp fileMatcher(<span class="stringliteral">"^file://(/.*\\.mesh)$"</span>);
<a name="l01145"></a>01145   <span class="keywordflow">if</span>( fileMatcher.exactMatch(evt-&gt;mimeData()-&gt;text()) )
<a name="l01146"></a>01146     evt-&gt;acceptProposedAction();
<a name="l01147"></a>01147 <span class="preprocessor">#endif</span>
<a name="l01148"></a>01148 <span class="preprocessor"></span>};
<a name="l01149"></a>01149 
<a name="l01150"></a>01150 
<a name="l01156"></a><a class="code" href="classOgreView.html#0f8ed6eb75bbf56f59cbd75887bd38cf">01156</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#0f8ed6eb75bbf56f59cbd75887bd38cf">OgreView::dropEvent</a>(QDropEvent* evt)
<a name="l01157"></a>01157 {
<a name="l01158"></a>01158 <span class="preprocessor">#if defined(Q_WS_WIN)</span>
<a name="l01159"></a>01159 <span class="preprocessor"></span>    QRegExp fileMatcher(<span class="stringliteral">"^/([A-Z]:/.*\\.mesh)$"</span>);
<a name="l01160"></a>01160     <span class="keywordflow">if</span>( fileMatcher.exactMatch(evt-&gt;mimeData()-&gt;urls().first().path()) )
<a name="l01161"></a>01161     {
<a name="l01162"></a>01162         QString meshName = fileMatcher.cap(1);
<a name="l01163"></a>01163         meshName.replace(<span class="stringliteral">"/"</span>, <span class="stringliteral">"\\"</span>);
<a name="l01164"></a>01164 <span class="preprocessor">#else</span>
<a name="l01165"></a>01165 <span class="preprocessor"></span>    QRegExp fileMatcher(<span class="stringliteral">"^file://(/.*\\.mesh)$"</span>);
<a name="l01166"></a>01166     <span class="keywordflow">if</span>( fileMatcher.exactMatch(evt-&gt;mimeData()-&gt;text()) )
<a name="l01167"></a>01167     {
<a name="l01168"></a>01168         QString meshName = fileMatcher.cap(1);
<a name="l01169"></a>01169 <span class="preprocessor">#endif</span>
<a name="l01170"></a>01170 <span class="preprocessor"></span>        <span class="comment">//              ((MainWindow*)parentWidget())-&gt;loadObj(meshName);</span>
<a name="l01171"></a>01171         evt-&gt;acceptProposedAction();
<a name="l01172"></a>01172     }
<a name="l01173"></a>01173 };
<a name="l01174"></a>01174 
<a name="l01183"></a><a class="code" href="classOgreView.html#c0e311cf86e376476f5db9fb2082b497">01183</a> <span class="keywordtype">void</span> <a class="code" href="classOgreView.html#c0e311cf86e376476f5db9fb2082b497">OgreView::selectObject</a>(QMouseEvent* evt){
<a name="l01184"></a>01184   LOGI(<span class="stringliteral">"OgreView::selectObject called"</span>);
<a name="l01185"></a>01185   Ogre::Real x, y;
<a name="l01186"></a>01186   x=(float)evt-&gt;x()/width();
<a name="l01187"></a>01187   y=(float)evt-&gt;y()/height();
<a name="l01188"></a>01188 
<a name="l01189"></a>01189   Ogre::Ray mouseRay = <a class="code" href="classOgreView.html#b29dcde63e577330f42b982205b9dbf2">mCamera</a>
<a name="l01190"></a>01190     -&gt;getCameraToViewportRay( x, y );
<a name="l01191"></a>01191   <a class="code" href="classOgreView.html#f823d38da59df79ff3f040530dc2d7b3">mRaySceneQuery</a>-&gt;setRay( mouseRay );
<a name="l01192"></a>01192 
<a name="l01193"></a>01193   Ogre::RaySceneQueryResult &amp;result = <a class="code" href="classOgreView.html#f823d38da59df79ff3f040530dc2d7b3">mRaySceneQuery</a>-&gt;execute();
<a name="l01194"></a>01194 
<a name="l01195"></a>01195   Ogre::String selName=<a class="code" href="classOgreView.html#4875c314d92b6f36a47ddc17743c273f">selectionCycle</a>-&gt;<a class="code" href="classRainbruRPG_1_1Editor_1_1SelectionCycle.html#994aba82978e6bb9a5d596e52292d886">getNextEntity</a>(result);
<a name="l01196"></a>01196   LOGCATS(<span class="stringliteral">"Selected object name : "</span>);
<a name="l01197"></a>01197   LOGCATS(selName.c_str());
<a name="l01198"></a>01198   LOGCAT();
<a name="l01199"></a>01199   SelectionManager::getSingleton().selectNewObject(selName);
<a name="l01200"></a>01200 
<a name="l01201"></a>01201 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 4 15:30:40 2007 for RainbruRPG by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
